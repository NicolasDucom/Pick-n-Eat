<html>
	<head>
		<link type="text/css" rel="stylesheet" href="{{ app.request.basepath }}/css/materialize.min.css" media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="{{ app.request.basepath }}/css/style.css" media="screen,projection"/>
		<link href='http://fonts.googleapis.com/css?family=Amatic+SC:400,700|Slabo+27px' rel='stylesheet' type='text/css'>
		<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
		<link type="text/css" rel="stylesheet" href="{{ app.request.basepath }}/css/animate.css" media="screen,projection"/>
	</head>
<body>
	<nav>
		<div class="container">
			<div class="nav-wrapper">
				<a href="#" class="brand-logo">Pick'n'eat</a>
				<ul id="nav-mobile" class="right side-nav">
					<li><a href="{{ app.url_generator.generate('home') }}"><i class="fa fa-home"></i></a></li>
					<li class="active"><a href="{{ app.url_generator.generate('random') }}" title="Random"><i class="fa fa-random"></i></a></li>
					<li><a href="{{ app.url_generator.generate('choose') }}" title="Choose"><i class="fa fa-pencil"></i></a></li>
				</ul>
				<a class="button-collapse" href="#" data-activates="nav-mobile"><i class="mdi-navigation-menu"></i></a>
			</div>
		</div>
	</nav>

	<div class="container">
		<div class="row">
			<div class="col s12">
				<h2>LET'S ROLL THE DICE.</h2>
			</div>

			<div id="results">
				<div class="col s12">
					<div class="card small" style="height: 470px; background: white;">
						<span id="restaurant_title" class="card-title"></span>
						<div class="card-content" style="background: white;">
							<div id="map-canvas"></div>
							<span id="restaurant_address"></span>
							<img id="restaurant_rating" src="">
						</div>
						<div class="card-action">
							<a href="#" id="restaurant_website">Website</a>
							<a href="#" id="restaurant_phone"></a>
						</div>
					</div>
					<p><a href="#" class="waves-effect waves-light btn-large btn-blue" id="replay_restaurant"><i class="fa fa-random"></i>Retry</a></p>
				</div>
			</div>
			<div id="random">
			<p><a href="#" class="waves-effect waves-light btn-large btn-green" id="random_restaurant"><i class="fa fa-random"></i>Random</a></p>
			</div>
			<div id="loading">
			<div class="preloader-wrapper big active animated bounceOutLeft">
			  <div class="spinner-layer spinner-blue">
			    <div class="circle-clipper left">
			      <div class="circle"></div>
			    </div><div class="gap-patch">
			      <div class="circle"></div>
			    </div><div class="circle-clipper right">
			      <div class="circle"></div>
			    </div>
			  </div>
			  <div class="spinner-layer spinner-red">
			    <div class="circle-clipper left">
			      <div class="circle"></div>
			    </div><div class="gap-patch">
			      <div class="circle"></div>
			    </div><div class="circle-clipper right">
			      <div class="circle"></div>
			    </div>
			  </div>
			  <div class="spinner-layer spinner-yellow">
			    <div class="circle-clipper left">
			      <div class="circle"></div>
			    </div><div class="gap-patch">
			      <div class="circle"></div>
			    </div><div class="circle-clipper right">
			      <div class="circle"></div>
			    </div>
			  </div>
			  <div class="spinner-layer spinner-green">
			    <div class="circle-clipper left">
			      <div class="circle"></div>
			    </div><div class="gap-patch">
			      <div class="circle"></div>
			    </div><div class="circle-clipper right">
			      <div class="circle"></div>
			    </div>
			  </div>
			</div>
		</div>
		</div>
	{% block javascripts %}	
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="{{ app.request.basepath }}/js/materialize.min.js"></script>
	<script type="text/javascript" src="{{ app.request.basepath }}/js/random.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js"></script>
	<script type="text/javascript">
		function initialize() {
	        var mapCanvas = document.getElementById('map-canvas');
	        var mapOptions = {
	          center: new google.maps.LatLng(0, 0),
	          zoom: 13,
	          mapTypeId: google.maps.MapTypeId.ROADMAP
	        }
	        var map = new google.maps.Map(mapCanvas, mapOptions)
	    }
	    google.maps.event.addDomListener(window, 'load', initialize);

		function getRandomRestaurant(position) {
		$('#loading').show(1, function() {
				$('#loading').addClass('animated bounceIn');
		});
		$.ajax({
			url: "{{ app.url_generator.generate('getRandom') }}",
			type: "GET",
			data: {longitude: position.coords.longitude,latitude:position.coords.latitude},
			dataType: "json",
			success: function (data) {
				if (typeof data.display_phone !== 'undefined') {
   					document.getElementById("restaurant_phone").innerHTML = data.display_phone;
				} else {
   					document.getElementById("restaurant_phone").innerHTML = "No phone number available";
				}
				if (typeof data.location.display_address !== 'undefined') {
   					document.getElementById("restaurant_address").innerHTML = data.location.display_address;
				} else {
   					document.getElementById("restaurant_address").innerHTML = "No address available";
				}
				document.getElementById("restaurant_title").innerHTML = data.name;	
   				document.getElementById("restaurant_address").innerHTML = data.location.display_address;
   				document.getElementById("restaurant_rating").src = data.rating_img_url_large;
				gMap = new google.maps.Map(document.getElementById('map-canvas')); 
				gMap.setCenter(new google.maps.LatLng(data.location.coordinate.latitude, data.location.coordinate.longitude));				
			},
			complete: function(){
        		$('#loading').fadeOut(420, function() {
			});
			$('#results').show(1, function() {
				$('#results').addClass('animated bounceIn');
			});
      		}
		});
	}
	</script>
	{% endblock %}
</body>
</html>